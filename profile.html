<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Profile</title>
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>

  <script>
    // Configuration Firebase
    const firebaseConfig = {
      apiKey: "AIzaSyCcxCO_FdIaEzXKpHiwWwTxNt7ZRGwcyl8",
      authDomain: "screen-clicker.firebaseapp.com",
      projectId: "screen-clicker",
      storageBucket: "screen-clicker.firebasestorage.app",
      messagingSenderId: "627573962958",
      appId: "1:627573962958:web:048f2577e436a30cf3389f",
      measurementId: "G-W3C5Y2YPBV"
    };

    // Initialise Firebase
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();
  </script>
</head>
<body class="min-h-screen flex items-center justify-center bg-gray-100 p-4">
  <div class="bg-white p-8 rounded-xl shadow-lg w-full max-w-sm text-center">
    <h1 class="text-2xl font-bold mb-4">Bienvenue !</h1>
    <p id="userInfo" class="text-gray-700 mb-2">Chargement des informations...</p>
    <button id="logoutBtn" class="mt-6 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700">
      Se déconnecter
    </button>
  </div>

  <script>
    // Attendre que l'authentification soit prête
    auth.onAuthStateChanged(async (user) => {
      if (user) {
        try {
          const userDoc = await db.collection('users').doc(user.uid).get();
          const userData = userDoc.data();

          document.getElementById('userInfo').textContent = 
            `Utilisateur : ${userData?.username || 'inconnu'}\nEmail : ${user.email}`;
        } catch (error) {
          document.getElementById('userInfo').textContent = 'Erreur lors de la récupération des données utilisateur.';
          console.error(error);
        }
      } else {
        // Pas connecté, redirection vers login
        window.location.href = 'login.html';
      }
    });

    // Bouton de déconnexion
    document.getElementById('logoutBtn').addEventListener('click', () => {
      auth.signOut().then(() => {
        window.location.href = 'login.html';
      });
    });
  </script>
</body>
</html>
